parameters:
  - name: platform
    type: string
  - name: version
    type: string

steps:
  - pwsh: |
      curl -sSL -o ${{parameters.version}}.${{parameters.platform}}-amd64.tar.gz https://dl.google.com/go/${{parameters.version}}.${{parameters.platform}}-amd64.tar.gz
      tar -xzf ${{parameters.version}}.${{parameters.platform}}-amd64.tar.gz "$(Build.SourcesDirectory)/../${{parameters.version}}"

      Write-Host "Prepending Path with $(Build.SourcesDirectory)/../${{parameters.version}}/bin"

      # also prepend the path permanently to ensure access the newly installed tools
      Write-Host "##vso[task.prependpath]$(Build.SourcesDirectory)/../${{parameters.version}}/bin"
    displayName: "Install Go Pre-release Version"
