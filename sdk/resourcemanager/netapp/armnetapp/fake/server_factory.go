// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See License.txt in the project root for license information.
// Code generated by Microsoft (R) Go Code Generator. DO NOT EDIT.

package fake

import (
	"errors"
	"fmt"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"net/http"
	"strings"
	"sync"
)

// ServerFactory is a fake server for instances of the armnetapp.ClientFactory type.
type ServerFactory struct {
	// AccountsServer contains the fakes for client AccountsClient
	AccountsServer AccountsServer

	// ActiveDirectoryConfigsServer contains the fakes for client ActiveDirectoryConfigsClient
	ActiveDirectoryConfigsServer ActiveDirectoryConfigsServer

	// BackupPoliciesServer contains the fakes for client BackupPoliciesClient
	BackupPoliciesServer BackupPoliciesServer

	// BackupVaultsServer contains the fakes for client BackupVaultsClient
	BackupVaultsServer BackupVaultsServer

	// BackupsServer contains the fakes for client BackupsClient
	BackupsServer BackupsServer

	// BackupsUnderAccountServer contains the fakes for client BackupsUnderAccountClient
	BackupsUnderAccountServer BackupsUnderAccountServer

	// BackupsUnderBackupVaultServer contains the fakes for client BackupsUnderBackupVaultClient
	BackupsUnderBackupVaultServer BackupsUnderBackupVaultServer

	// BackupsUnderVolumeServer contains the fakes for client BackupsUnderVolumeClient
	BackupsUnderVolumeServer BackupsUnderVolumeServer

	// BucketsServer contains the fakes for client BucketsClient
	BucketsServer BucketsServer

	// CachesServer contains the fakes for client CachesClient
	CachesServer CachesServer

	// ElasticAccountsServer contains the fakes for client ElasticAccountsClient
	ElasticAccountsServer ElasticAccountsServer

	// ElasticBackupPoliciesServer contains the fakes for client ElasticBackupPoliciesClient
	ElasticBackupPoliciesServer ElasticBackupPoliciesServer

	// ElasticBackupVaultsServer contains the fakes for client ElasticBackupVaultsClient
	ElasticBackupVaultsServer ElasticBackupVaultsServer

	// ElasticBackupsServer contains the fakes for client ElasticBackupsClient
	ElasticBackupsServer ElasticBackupsServer

	// ElasticCapacityPoolsServer contains the fakes for client ElasticCapacityPoolsClient
	ElasticCapacityPoolsServer ElasticCapacityPoolsServer

	// ElasticSnapshotPoliciesServer contains the fakes for client ElasticSnapshotPoliciesClient
	ElasticSnapshotPoliciesServer ElasticSnapshotPoliciesServer

	// ElasticSnapshotsServer contains the fakes for client ElasticSnapshotsClient
	ElasticSnapshotsServer ElasticSnapshotsServer

	// ElasticVolumesServer contains the fakes for client ElasticVolumesClient
	ElasticVolumesServer ElasticVolumesServer

	// NetAppResourceServer contains the fakes for client NetAppResourceClient
	NetAppResourceServer NetAppResourceServer

	// NetAppResourceQuotaLimitsAccountServer contains the fakes for client NetAppResourceQuotaLimitsAccountClient
	NetAppResourceQuotaLimitsAccountServer NetAppResourceQuotaLimitsAccountServer

	// NetAppResourceQuotaLimitsServer contains the fakes for client NetAppResourceQuotaLimitsClient
	NetAppResourceQuotaLimitsServer NetAppResourceQuotaLimitsServer

	// NetAppResourceRegionInfosServer contains the fakes for client NetAppResourceRegionInfosClient
	NetAppResourceRegionInfosServer NetAppResourceRegionInfosServer

	// NetAppResourceUsagesServer contains the fakes for client NetAppResourceUsagesClient
	NetAppResourceUsagesServer NetAppResourceUsagesServer

	// OperationsServer contains the fakes for client OperationsClient
	OperationsServer OperationsServer

	// PoolsServer contains the fakes for client PoolsClient
	PoolsServer PoolsServer

	// RansomwareReportsServer contains the fakes for client RansomwareReportsClient
	RansomwareReportsServer RansomwareReportsServer

	// SnapshotPoliciesServer contains the fakes for client SnapshotPoliciesClient
	SnapshotPoliciesServer SnapshotPoliciesServer

	// SnapshotsServer contains the fakes for client SnapshotsClient
	SnapshotsServer SnapshotsServer

	// SubvolumesServer contains the fakes for client SubvolumesClient
	SubvolumesServer SubvolumesServer

	// VolumeGroupsServer contains the fakes for client VolumeGroupsClient
	VolumeGroupsServer VolumeGroupsServer

	// VolumeQuotaRulesServer contains the fakes for client VolumeQuotaRulesClient
	VolumeQuotaRulesServer VolumeQuotaRulesServer

	// VolumesServer contains the fakes for client VolumesClient
	VolumesServer VolumesServer
}

// NewServerFactoryTransport creates a new instance of ServerFactoryTransport with the provided implementation.
// The returned ServerFactoryTransport instance is connected to an instance of armnetapp.ClientFactory via the
// azcore.ClientOptions.Transporter field in the client's constructor parameters.
func NewServerFactoryTransport(srv *ServerFactory) *ServerFactoryTransport {
	return &ServerFactoryTransport{
		srv: srv,
	}
}

// ServerFactoryTransport connects instances of armnetapp.ClientFactory to instances of ServerFactory.
// Don't use this type directly, use NewServerFactoryTransport instead.
type ServerFactoryTransport struct {
	srv                                      *ServerFactory
	trMu                                     sync.Mutex
	trAccountsServer                         *AccountsServerTransport
	trActiveDirectoryConfigsServer           *ActiveDirectoryConfigsServerTransport
	trBackupPoliciesServer                   *BackupPoliciesServerTransport
	trBackupVaultsServer                     *BackupVaultsServerTransport
	trBackupsServer                          *BackupsServerTransport
	trBackupsUnderAccountServer              *BackupsUnderAccountServerTransport
	trBackupsUnderBackupVaultServer          *BackupsUnderBackupVaultServerTransport
	trBackupsUnderVolumeServer               *BackupsUnderVolumeServerTransport
	trBucketsServer                          *BucketsServerTransport
	trCachesServer                           *CachesServerTransport
	trElasticAccountsServer                  *ElasticAccountsServerTransport
	trElasticBackupPoliciesServer            *ElasticBackupPoliciesServerTransport
	trElasticBackupVaultsServer              *ElasticBackupVaultsServerTransport
	trElasticBackupsServer                   *ElasticBackupsServerTransport
	trElasticCapacityPoolsServer             *ElasticCapacityPoolsServerTransport
	trElasticSnapshotPoliciesServer          *ElasticSnapshotPoliciesServerTransport
	trElasticSnapshotsServer                 *ElasticSnapshotsServerTransport
	trElasticVolumesServer                   *ElasticVolumesServerTransport
	trNetAppResourceServer                   *NetAppResourceServerTransport
	trNetAppResourceQuotaLimitsAccountServer *NetAppResourceQuotaLimitsAccountServerTransport
	trNetAppResourceQuotaLimitsServer        *NetAppResourceQuotaLimitsServerTransport
	trNetAppResourceRegionInfosServer        *NetAppResourceRegionInfosServerTransport
	trNetAppResourceUsagesServer             *NetAppResourceUsagesServerTransport
	trOperationsServer                       *OperationsServerTransport
	trPoolsServer                            *PoolsServerTransport
	trRansomwareReportsServer                *RansomwareReportsServerTransport
	trSnapshotPoliciesServer                 *SnapshotPoliciesServerTransport
	trSnapshotsServer                        *SnapshotsServerTransport
	trSubvolumesServer                       *SubvolumesServerTransport
	trVolumeGroupsServer                     *VolumeGroupsServerTransport
	trVolumeQuotaRulesServer                 *VolumeQuotaRulesServerTransport
	trVolumesServer                          *VolumesServerTransport
}

// Do implements the policy.Transporter interface for ServerFactoryTransport.
func (s *ServerFactoryTransport) Do(req *http.Request) (*http.Response, error) {
	rawMethod := req.Context().Value(runtime.CtxAPINameKey{})
	method, ok := rawMethod.(string)
	if !ok {
		return nil, nonRetriableError{errors.New("unable to dispatch request, missing value for CtxAPINameKey")}
	}

	client := method[:strings.Index(method, ".")]
	var resp *http.Response
	var err error

	switch client {
	case "AccountsClient":
		initServer(s, &s.trAccountsServer, func() *AccountsServerTransport { return NewAccountsServerTransport(&s.srv.AccountsServer) })
		resp, err = s.trAccountsServer.Do(req)
	case "ActiveDirectoryConfigsClient":
		initServer(s, &s.trActiveDirectoryConfigsServer, func() *ActiveDirectoryConfigsServerTransport {
			return NewActiveDirectoryConfigsServerTransport(&s.srv.ActiveDirectoryConfigsServer)
		})
		resp, err = s.trActiveDirectoryConfigsServer.Do(req)
	case "BackupPoliciesClient":
		initServer(s, &s.trBackupPoliciesServer, func() *BackupPoliciesServerTransport {
			return NewBackupPoliciesServerTransport(&s.srv.BackupPoliciesServer)
		})
		resp, err = s.trBackupPoliciesServer.Do(req)
	case "BackupVaultsClient":
		initServer(s, &s.trBackupVaultsServer, func() *BackupVaultsServerTransport { return NewBackupVaultsServerTransport(&s.srv.BackupVaultsServer) })
		resp, err = s.trBackupVaultsServer.Do(req)
	case "BackupsClient":
		initServer(s, &s.trBackupsServer, func() *BackupsServerTransport { return NewBackupsServerTransport(&s.srv.BackupsServer) })
		resp, err = s.trBackupsServer.Do(req)
	case "BackupsUnderAccountClient":
		initServer(s, &s.trBackupsUnderAccountServer, func() *BackupsUnderAccountServerTransport {
			return NewBackupsUnderAccountServerTransport(&s.srv.BackupsUnderAccountServer)
		})
		resp, err = s.trBackupsUnderAccountServer.Do(req)
	case "BackupsUnderBackupVaultClient":
		initServer(s, &s.trBackupsUnderBackupVaultServer, func() *BackupsUnderBackupVaultServerTransport {
			return NewBackupsUnderBackupVaultServerTransport(&s.srv.BackupsUnderBackupVaultServer)
		})
		resp, err = s.trBackupsUnderBackupVaultServer.Do(req)
	case "BackupsUnderVolumeClient":
		initServer(s, &s.trBackupsUnderVolumeServer, func() *BackupsUnderVolumeServerTransport {
			return NewBackupsUnderVolumeServerTransport(&s.srv.BackupsUnderVolumeServer)
		})
		resp, err = s.trBackupsUnderVolumeServer.Do(req)
	case "BucketsClient":
		initServer(s, &s.trBucketsServer, func() *BucketsServerTransport { return NewBucketsServerTransport(&s.srv.BucketsServer) })
		resp, err = s.trBucketsServer.Do(req)
	case "CachesClient":
		initServer(s, &s.trCachesServer, func() *CachesServerTransport { return NewCachesServerTransport(&s.srv.CachesServer) })
		resp, err = s.trCachesServer.Do(req)
	case "ElasticAccountsClient":
		initServer(s, &s.trElasticAccountsServer, func() *ElasticAccountsServerTransport {
			return NewElasticAccountsServerTransport(&s.srv.ElasticAccountsServer)
		})
		resp, err = s.trElasticAccountsServer.Do(req)
	case "ElasticBackupPoliciesClient":
		initServer(s, &s.trElasticBackupPoliciesServer, func() *ElasticBackupPoliciesServerTransport {
			return NewElasticBackupPoliciesServerTransport(&s.srv.ElasticBackupPoliciesServer)
		})
		resp, err = s.trElasticBackupPoliciesServer.Do(req)
	case "ElasticBackupVaultsClient":
		initServer(s, &s.trElasticBackupVaultsServer, func() *ElasticBackupVaultsServerTransport {
			return NewElasticBackupVaultsServerTransport(&s.srv.ElasticBackupVaultsServer)
		})
		resp, err = s.trElasticBackupVaultsServer.Do(req)
	case "ElasticBackupsClient":
		initServer(s, &s.trElasticBackupsServer, func() *ElasticBackupsServerTransport {
			return NewElasticBackupsServerTransport(&s.srv.ElasticBackupsServer)
		})
		resp, err = s.trElasticBackupsServer.Do(req)
	case "ElasticCapacityPoolsClient":
		initServer(s, &s.trElasticCapacityPoolsServer, func() *ElasticCapacityPoolsServerTransport {
			return NewElasticCapacityPoolsServerTransport(&s.srv.ElasticCapacityPoolsServer)
		})
		resp, err = s.trElasticCapacityPoolsServer.Do(req)
	case "ElasticSnapshotPoliciesClient":
		initServer(s, &s.trElasticSnapshotPoliciesServer, func() *ElasticSnapshotPoliciesServerTransport {
			return NewElasticSnapshotPoliciesServerTransport(&s.srv.ElasticSnapshotPoliciesServer)
		})
		resp, err = s.trElasticSnapshotPoliciesServer.Do(req)
	case "ElasticSnapshotsClient":
		initServer(s, &s.trElasticSnapshotsServer, func() *ElasticSnapshotsServerTransport {
			return NewElasticSnapshotsServerTransport(&s.srv.ElasticSnapshotsServer)
		})
		resp, err = s.trElasticSnapshotsServer.Do(req)
	case "ElasticVolumesClient":
		initServer(s, &s.trElasticVolumesServer, func() *ElasticVolumesServerTransport {
			return NewElasticVolumesServerTransport(&s.srv.ElasticVolumesServer)
		})
		resp, err = s.trElasticVolumesServer.Do(req)
	case "NetAppResourceClient":
		initServer(s, &s.trNetAppResourceServer, func() *NetAppResourceServerTransport {
			return NewNetAppResourceServerTransport(&s.srv.NetAppResourceServer)
		})
		resp, err = s.trNetAppResourceServer.Do(req)
	case "NetAppResourceQuotaLimitsAccountClient":
		initServer(s, &s.trNetAppResourceQuotaLimitsAccountServer, func() *NetAppResourceQuotaLimitsAccountServerTransport {
			return NewNetAppResourceQuotaLimitsAccountServerTransport(&s.srv.NetAppResourceQuotaLimitsAccountServer)
		})
		resp, err = s.trNetAppResourceQuotaLimitsAccountServer.Do(req)
	case "NetAppResourceQuotaLimitsClient":
		initServer(s, &s.trNetAppResourceQuotaLimitsServer, func() *NetAppResourceQuotaLimitsServerTransport {
			return NewNetAppResourceQuotaLimitsServerTransport(&s.srv.NetAppResourceQuotaLimitsServer)
		})
		resp, err = s.trNetAppResourceQuotaLimitsServer.Do(req)
	case "NetAppResourceRegionInfosClient":
		initServer(s, &s.trNetAppResourceRegionInfosServer, func() *NetAppResourceRegionInfosServerTransport {
			return NewNetAppResourceRegionInfosServerTransport(&s.srv.NetAppResourceRegionInfosServer)
		})
		resp, err = s.trNetAppResourceRegionInfosServer.Do(req)
	case "NetAppResourceUsagesClient":
		initServer(s, &s.trNetAppResourceUsagesServer, func() *NetAppResourceUsagesServerTransport {
			return NewNetAppResourceUsagesServerTransport(&s.srv.NetAppResourceUsagesServer)
		})
		resp, err = s.trNetAppResourceUsagesServer.Do(req)
	case "OperationsClient":
		initServer(s, &s.trOperationsServer, func() *OperationsServerTransport { return NewOperationsServerTransport(&s.srv.OperationsServer) })
		resp, err = s.trOperationsServer.Do(req)
	case "PoolsClient":
		initServer(s, &s.trPoolsServer, func() *PoolsServerTransport { return NewPoolsServerTransport(&s.srv.PoolsServer) })
		resp, err = s.trPoolsServer.Do(req)
	case "RansomwareReportsClient":
		initServer(s, &s.trRansomwareReportsServer, func() *RansomwareReportsServerTransport {
			return NewRansomwareReportsServerTransport(&s.srv.RansomwareReportsServer)
		})
		resp, err = s.trRansomwareReportsServer.Do(req)
	case "SnapshotPoliciesClient":
		initServer(s, &s.trSnapshotPoliciesServer, func() *SnapshotPoliciesServerTransport {
			return NewSnapshotPoliciesServerTransport(&s.srv.SnapshotPoliciesServer)
		})
		resp, err = s.trSnapshotPoliciesServer.Do(req)
	case "SnapshotsClient":
		initServer(s, &s.trSnapshotsServer, func() *SnapshotsServerTransport { return NewSnapshotsServerTransport(&s.srv.SnapshotsServer) })
		resp, err = s.trSnapshotsServer.Do(req)
	case "SubvolumesClient":
		initServer(s, &s.trSubvolumesServer, func() *SubvolumesServerTransport { return NewSubvolumesServerTransport(&s.srv.SubvolumesServer) })
		resp, err = s.trSubvolumesServer.Do(req)
	case "VolumeGroupsClient":
		initServer(s, &s.trVolumeGroupsServer, func() *VolumeGroupsServerTransport { return NewVolumeGroupsServerTransport(&s.srv.VolumeGroupsServer) })
		resp, err = s.trVolumeGroupsServer.Do(req)
	case "VolumeQuotaRulesClient":
		initServer(s, &s.trVolumeQuotaRulesServer, func() *VolumeQuotaRulesServerTransport {
			return NewVolumeQuotaRulesServerTransport(&s.srv.VolumeQuotaRulesServer)
		})
		resp, err = s.trVolumeQuotaRulesServer.Do(req)
	case "VolumesClient":
		initServer(s, &s.trVolumesServer, func() *VolumesServerTransport { return NewVolumesServerTransport(&s.srv.VolumesServer) })
		resp, err = s.trVolumesServer.Do(req)
	default:
		err = fmt.Errorf("unhandled client %s", client)
	}

	if err != nil {
		return nil, err
	}

	return resp, nil
}

func initServer[T any](s *ServerFactoryTransport, dst **T, src func() *T) {
	s.trMu.Lock()
	if *dst == nil {
		*dst = src()
	}
	s.trMu.Unlock()
}
