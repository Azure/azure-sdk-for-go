// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See License.txt in the project root for license information.
// Code generated by Microsoft (R) Go Code Generator. DO NOT EDIT.

package armsecurityinsights

import (
	"context"
	"errors"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/arm"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/policy"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"net/http"
	"net/url"
	"strings"
)

// Client - API spec for Microsoft.SecurityInsights (Azure Security Insights) resource provider
// Don't use this type directly, use NewClient() instead.
type Client struct {
	internal       *arm.Client
	subscriptionID string
}

// NewClient creates a new instance of Client with the specified values.
//   - subscriptionID - The ID of the target subscription. The value must be an UUID.
//   - credential - used to authorize requests. Usually a credential from azidentity.
//   - options - Contains optional client configuration. Pass nil to accept the default values.
func NewClient(subscriptionID string, credential azcore.TokenCredential, options *arm.ClientOptions) (*Client, error) {
	cl, err := arm.NewClient(moduleName, moduleVersion, credential, options)
	if err != nil {
		return nil, err
	}
	client := &Client{
		subscriptionID: subscriptionID,
		internal:       cl,
	}
	return client, nil
}

// NewActionsClient creates a new instance of [ActionsClient].
func (client *Client) NewActionsClient() *ActionsClient {
	return &ActionsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewAlertRuleClient creates a new instance of [AlertRuleClient].
func (client *Client) NewAlertRuleClient() *AlertRuleClient {
	return &AlertRuleClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewAlertRuleTemplatesClient creates a new instance of [AlertRuleTemplatesClient].
func (client *Client) NewAlertRuleTemplatesClient() *AlertRuleTemplatesClient {
	return &AlertRuleTemplatesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewAlertRulesClient creates a new instance of [AlertRulesClient].
func (client *Client) NewAlertRulesClient() *AlertRulesClient {
	return &AlertRulesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewAutomationRulesClient creates a new instance of [AutomationRulesClient].
func (client *Client) NewAutomationRulesClient() *AutomationRulesClient {
	return &AutomationRulesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewBillingStatisticsClient creates a new instance of [BillingStatisticsClient].
func (client *Client) NewBillingStatisticsClient() *BillingStatisticsClient {
	return &BillingStatisticsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewBookmarkClient creates a new instance of [BookmarkClient].
func (client *Client) NewBookmarkClient() *BookmarkClient {
	return &BookmarkClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewBookmarkRelationsClient creates a new instance of [BookmarkRelationsClient].
func (client *Client) NewBookmarkRelationsClient() *BookmarkRelationsClient {
	return &BookmarkRelationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewBookmarksClient creates a new instance of [BookmarksClient].
func (client *Client) NewBookmarksClient() *BookmarksClient {
	return &BookmarksClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewContentPackageClient creates a new instance of [ContentPackageClient].
func (client *Client) NewContentPackageClient() *ContentPackageClient {
	return &ContentPackageClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewContentPackagesClient creates a new instance of [ContentPackagesClient].
func (client *Client) NewContentPackagesClient() *ContentPackagesClient {
	return &ContentPackagesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewContentTemplateClient creates a new instance of [ContentTemplateClient].
func (client *Client) NewContentTemplateClient() *ContentTemplateClient {
	return &ContentTemplateClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewContentTemplatesClient creates a new instance of [ContentTemplatesClient].
func (client *Client) NewContentTemplatesClient() *ContentTemplatesClient {
	return &ContentTemplatesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewDataConnectorDefinitionsClient creates a new instance of [DataConnectorDefinitionsClient].
func (client *Client) NewDataConnectorDefinitionsClient() *DataConnectorDefinitionsClient {
	return &DataConnectorDefinitionsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewDataConnectorsCheckRequirementsClient creates a new instance of [DataConnectorsCheckRequirementsClient].
func (client *Client) NewDataConnectorsCheckRequirementsClient() *DataConnectorsCheckRequirementsClient {
	return &DataConnectorsCheckRequirementsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewDataConnectorsClient creates a new instance of [DataConnectorsClient].
func (client *Client) NewDataConnectorsClient() *DataConnectorsClient {
	return &DataConnectorsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntitiesClient creates a new instance of [EntitiesClient].
func (client *Client) NewEntitiesClient() *EntitiesClient {
	return &EntitiesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntitiesGetTimelineClient creates a new instance of [EntitiesGetTimelineClient].
func (client *Client) NewEntitiesGetTimelineClient() *EntitiesGetTimelineClient {
	return &EntitiesGetTimelineClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntitiesRelationsClient creates a new instance of [EntitiesRelationsClient].
func (client *Client) NewEntitiesRelationsClient() *EntitiesRelationsClient {
	return &EntitiesRelationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntityQueriesClient creates a new instance of [EntityQueriesClient].
func (client *Client) NewEntityQueriesClient() *EntityQueriesClient {
	return &EntityQueriesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntityQueryTemplatesClient creates a new instance of [EntityQueryTemplatesClient].
func (client *Client) NewEntityQueryTemplatesClient() *EntityQueryTemplatesClient {
	return &EntityQueryTemplatesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewEntityRelationsClient creates a new instance of [EntityRelationsClient].
func (client *Client) NewEntityRelationsClient() *EntityRelationsClient {
	return &EntityRelationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewFileImportsClient creates a new instance of [FileImportsClient].
func (client *Client) NewFileImportsClient() *FileImportsClient {
	return &FileImportsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewGetClient creates a new instance of [GetClient].
func (client *Client) NewGetClient() *GetClient {
	return &GetClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewGetRecommendationsClient creates a new instance of [GetRecommendationsClient].
func (client *Client) NewGetRecommendationsClient() *GetRecommendationsClient {
	return &GetRecommendationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewGetTriggeredAnalyticsRuleRunsClient creates a new instance of [GetTriggeredAnalyticsRuleRunsClient].
func (client *Client) NewGetTriggeredAnalyticsRuleRunsClient() *GetTriggeredAnalyticsRuleRunsClient {
	return &GetTriggeredAnalyticsRuleRunsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewHuntCommentsClient creates a new instance of [HuntCommentsClient].
func (client *Client) NewHuntCommentsClient() *HuntCommentsClient {
	return &HuntCommentsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewHuntRelationsClient creates a new instance of [HuntRelationsClient].
func (client *Client) NewHuntRelationsClient() *HuntRelationsClient {
	return &HuntRelationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewHuntsClient creates a new instance of [HuntsClient].
func (client *Client) NewHuntsClient() *HuntsClient {
	return &HuntsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewIncidentCommentsClient creates a new instance of [IncidentCommentsClient].
func (client *Client) NewIncidentCommentsClient() *IncidentCommentsClient {
	return &IncidentCommentsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewIncidentRelationsClient creates a new instance of [IncidentRelationsClient].
func (client *Client) NewIncidentRelationsClient() *IncidentRelationsClient {
	return &IncidentRelationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewIncidentTasksClient creates a new instance of [IncidentTasksClient].
func (client *Client) NewIncidentTasksClient() *IncidentTasksClient {
	return &IncidentTasksClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewIncidentsClient creates a new instance of [IncidentsClient].
func (client *Client) NewIncidentsClient() *IncidentsClient {
	return &IncidentsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewMetadataClient creates a new instance of [MetadataClient].
func (client *Client) NewMetadataClient() *MetadataClient {
	return &MetadataClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewOfficeConsentsClient creates a new instance of [OfficeConsentsClient].
func (client *Client) NewOfficeConsentsClient() *OfficeConsentsClient {
	return &OfficeConsentsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewOperationsClient creates a new instance of [OperationsClient].
func (client *Client) NewOperationsClient() *OperationsClient {
	return &OperationsClient{
		internal: client.internal,
	}
}

// NewProductPackageClient creates a new instance of [ProductPackageClient].
func (client *Client) NewProductPackageClient() *ProductPackageClient {
	return &ProductPackageClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewProductPackagesClient creates a new instance of [ProductPackagesClient].
func (client *Client) NewProductPackagesClient() *ProductPackagesClient {
	return &ProductPackagesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewProductSettingsClient creates a new instance of [ProductSettingsClient].
func (client *Client) NewProductSettingsClient() *ProductSettingsClient {
	return &ProductSettingsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewProductTemplateClient creates a new instance of [ProductTemplateClient].
func (client *Client) NewProductTemplateClient() *ProductTemplateClient {
	return &ProductTemplateClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewProductTemplatesClient creates a new instance of [ProductTemplatesClient].
func (client *Client) NewProductTemplatesClient() *ProductTemplatesClient {
	return &ProductTemplatesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewReevaluateClient creates a new instance of [ReevaluateClient].
func (client *Client) NewReevaluateClient() *ReevaluateClient {
	return &ReevaluateClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewSecurityMLAnalyticsSettingsClient creates a new instance of [SecurityMLAnalyticsSettingsClient].
func (client *Client) NewSecurityMLAnalyticsSettingsClient() *SecurityMLAnalyticsSettingsClient {
	return &SecurityMLAnalyticsSettingsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewSentinelOnboardingStatesClient creates a new instance of [SentinelOnboardingStatesClient].
func (client *Client) NewSentinelOnboardingStatesClient() *SentinelOnboardingStatesClient {
	return &SentinelOnboardingStatesClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewSourceControlClient creates a new instance of [SourceControlClient].
func (client *Client) NewSourceControlClient() *SourceControlClient {
	return &SourceControlClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewSourceControlsClient creates a new instance of [SourceControlsClient].
func (client *Client) NewSourceControlsClient() *SourceControlsClient {
	return &SourceControlsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewThreatIntelligenceClient creates a new instance of [ThreatIntelligenceClient].
func (client *Client) NewThreatIntelligenceClient() *ThreatIntelligenceClient {
	return &ThreatIntelligenceClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewThreatIntelligenceIndicatorClient creates a new instance of [ThreatIntelligenceIndicatorClient].
func (client *Client) NewThreatIntelligenceIndicatorClient() *ThreatIntelligenceIndicatorClient {
	return &ThreatIntelligenceIndicatorClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewThreatIntelligenceIndicatorMetricsClient creates a new instance of [ThreatIntelligenceIndicatorMetricsClient].
func (client *Client) NewThreatIntelligenceIndicatorMetricsClient() *ThreatIntelligenceIndicatorMetricsClient {
	return &ThreatIntelligenceIndicatorMetricsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewThreatIntelligenceIndicatorsClient creates a new instance of [ThreatIntelligenceIndicatorsClient].
func (client *Client) NewThreatIntelligenceIndicatorsClient() *ThreatIntelligenceIndicatorsClient {
	return &ThreatIntelligenceIndicatorsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewTriggeredAnalyticsRuleRunClient creates a new instance of [TriggeredAnalyticsRuleRunClient].
func (client *Client) NewTriggeredAnalyticsRuleRunClient() *TriggeredAnalyticsRuleRunClient {
	return &TriggeredAnalyticsRuleRunClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewUpdateClient creates a new instance of [UpdateClient].
func (client *Client) NewUpdateClient() *UpdateClient {
	return &UpdateClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWatchlistItemsClient creates a new instance of [WatchlistItemsClient].
func (client *Client) NewWatchlistItemsClient() *WatchlistItemsClient {
	return &WatchlistItemsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWatchlistsClient creates a new instance of [WatchlistsClient].
func (client *Client) NewWatchlistsClient() *WatchlistsClient {
	return &WatchlistsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWorkspaceManagerAssignmentJobsClient creates a new instance of [WorkspaceManagerAssignmentJobsClient].
func (client *Client) NewWorkspaceManagerAssignmentJobsClient() *WorkspaceManagerAssignmentJobsClient {
	return &WorkspaceManagerAssignmentJobsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWorkspaceManagerAssignmentsClient creates a new instance of [WorkspaceManagerAssignmentsClient].
func (client *Client) NewWorkspaceManagerAssignmentsClient() *WorkspaceManagerAssignmentsClient {
	return &WorkspaceManagerAssignmentsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWorkspaceManagerConfigurationsClient creates a new instance of [WorkspaceManagerConfigurationsClient].
func (client *Client) NewWorkspaceManagerConfigurationsClient() *WorkspaceManagerConfigurationsClient {
	return &WorkspaceManagerConfigurationsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWorkspaceManagerGroupsClient creates a new instance of [WorkspaceManagerGroupsClient].
func (client *Client) NewWorkspaceManagerGroupsClient() *WorkspaceManagerGroupsClient {
	return &WorkspaceManagerGroupsClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// NewWorkspaceManagerMembersClient creates a new instance of [WorkspaceManagerMembersClient].
func (client *Client) NewWorkspaceManagerMembersClient() *WorkspaceManagerMembersClient {
	return &WorkspaceManagerMembersClient{
		internal:       client.internal,
		subscriptionID: client.subscriptionID,
	}
}

// ListGeodataByIP - Get geodata for a single IP address
// If the operation fails it returns an *azcore.ResponseError type.
//
// Generated from API version 2025-07-01-preview
//   - resourceGroupName - The name of the resource group. The name is case insensitive.
//   - workspaceName - The name of the workspace.
//   - enrichmentType - Enrichment type
//   - ipAddressBody - IP address (v4 or v6) to be enriched
//   - options - ClientListGeodataByIPOptions contains the optional parameters for the Client.ListGeodataByIP method.
func (client *Client) ListGeodataByIP(ctx context.Context, resourceGroupName string, workspaceName string, enrichmentType EnrichmentType, ipAddressBody EnrichmentIPAddressBody, options *ClientListGeodataByIPOptions) (ClientListGeodataByIPResponse, error) {
	var err error
	const operationName = "Client.ListGeodataByIP"
	ctx = context.WithValue(ctx, runtime.CtxAPINameKey{}, operationName)
	ctx, endSpan := runtime.StartSpan(ctx, operationName, client.internal.Tracer(), nil)
	defer func() { endSpan(err) }()
	req, err := client.listGeodataByIPCreateRequest(ctx, resourceGroupName, workspaceName, enrichmentType, ipAddressBody, options)
	if err != nil {
		return ClientListGeodataByIPResponse{}, err
	}
	httpResp, err := client.internal.Pipeline().Do(req)
	if err != nil {
		return ClientListGeodataByIPResponse{}, err
	}
	if !runtime.HasStatusCode(httpResp, http.StatusOK) {
		err = runtime.NewResponseError(httpResp)
		return ClientListGeodataByIPResponse{}, err
	}
	resp, err := client.listGeodataByIPHandleResponse(httpResp)
	return resp, err
}

// listGeodataByIPCreateRequest creates the ListGeodataByIP request.
func (client *Client) listGeodataByIPCreateRequest(ctx context.Context, resourceGroupName string, workspaceName string, enrichmentType EnrichmentType, ipAddressBody EnrichmentIPAddressBody, _ *ClientListGeodataByIPOptions) (*policy.Request, error) {
	urlPath := "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/enrichment/{enrichmentType}/listGeodataByIp"
	if client.subscriptionID == "" {
		return nil, errors.New("parameter client.subscriptionID cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{subscriptionId}", url.PathEscape(client.subscriptionID))
	if resourceGroupName == "" {
		return nil, errors.New("parameter resourceGroupName cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{resourceGroupName}", url.PathEscape(resourceGroupName))
	if workspaceName == "" {
		return nil, errors.New("parameter workspaceName cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{workspaceName}", url.PathEscape(workspaceName))
	if enrichmentType == "" {
		return nil, errors.New("parameter enrichmentType cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{enrichmentType}", url.PathEscape(string(enrichmentType)))
	req, err := runtime.NewRequest(ctx, http.MethodPost, runtime.JoinPaths(client.internal.Endpoint(), urlPath))
	if err != nil {
		return nil, err
	}
	reqQP := req.Raw().URL.Query()
	reqQP.Set("api-version", "2025-07-01-preview")
	req.Raw().URL.RawQuery = reqQP.Encode()
	req.Raw().Header["Accept"] = []string{"application/json"}
	req.Raw().Header["Content-Type"] = []string{"application/json"}
	if err := runtime.MarshalAsJSON(req, ipAddressBody); err != nil {
		return nil, err
	}
	return req, nil
}

// listGeodataByIPHandleResponse handles the ListGeodataByIP response.
func (client *Client) listGeodataByIPHandleResponse(resp *http.Response) (ClientListGeodataByIPResponse, error) {
	result := ClientListGeodataByIPResponse{}
	if err := runtime.UnmarshalAsJSON(resp, &result.EnrichmentIPGeodata); err != nil {
		return ClientListGeodataByIPResponse{}, err
	}
	return result, nil
}

// ListWhoisByDomain - Get whois information for a single domain name
// If the operation fails it returns an *azcore.ResponseError type.
//
// Generated from API version 2025-07-01-preview
//   - resourceGroupName - The name of the resource group. The name is case insensitive.
//   - workspaceName - The name of the workspace.
//   - enrichmentType - Enrichment type
//   - domainBody - Domain name to be enriched. Only domain name is accepted
//   - options - ClientListWhoisByDomainOptions contains the optional parameters for the Client.ListWhoisByDomain method.
func (client *Client) ListWhoisByDomain(ctx context.Context, resourceGroupName string, workspaceName string, enrichmentType EnrichmentType, domainBody EnrichmentDomainBody, options *ClientListWhoisByDomainOptions) (ClientListWhoisByDomainResponse, error) {
	var err error
	const operationName = "Client.ListWhoisByDomain"
	ctx = context.WithValue(ctx, runtime.CtxAPINameKey{}, operationName)
	ctx, endSpan := runtime.StartSpan(ctx, operationName, client.internal.Tracer(), nil)
	defer func() { endSpan(err) }()
	req, err := client.listWhoisByDomainCreateRequest(ctx, resourceGroupName, workspaceName, enrichmentType, domainBody, options)
	if err != nil {
		return ClientListWhoisByDomainResponse{}, err
	}
	httpResp, err := client.internal.Pipeline().Do(req)
	if err != nil {
		return ClientListWhoisByDomainResponse{}, err
	}
	if !runtime.HasStatusCode(httpResp, http.StatusOK) {
		err = runtime.NewResponseError(httpResp)
		return ClientListWhoisByDomainResponse{}, err
	}
	resp, err := client.listWhoisByDomainHandleResponse(httpResp)
	return resp, err
}

// listWhoisByDomainCreateRequest creates the ListWhoisByDomain request.
func (client *Client) listWhoisByDomainCreateRequest(ctx context.Context, resourceGroupName string, workspaceName string, enrichmentType EnrichmentType, domainBody EnrichmentDomainBody, _ *ClientListWhoisByDomainOptions) (*policy.Request, error) {
	urlPath := "/subscriptions/{subscriptionId}/resourceGroups/{resourceGroupName}/providers/Microsoft.OperationalInsights/workspaces/{workspaceName}/providers/Microsoft.SecurityInsights/enrichment/{enrichmentType}/listWhoisByDomain"
	if client.subscriptionID == "" {
		return nil, errors.New("parameter client.subscriptionID cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{subscriptionId}", url.PathEscape(client.subscriptionID))
	if resourceGroupName == "" {
		return nil, errors.New("parameter resourceGroupName cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{resourceGroupName}", url.PathEscape(resourceGroupName))
	if workspaceName == "" {
		return nil, errors.New("parameter workspaceName cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{workspaceName}", url.PathEscape(workspaceName))
	if enrichmentType == "" {
		return nil, errors.New("parameter enrichmentType cannot be empty")
	}
	urlPath = strings.ReplaceAll(urlPath, "{enrichmentType}", url.PathEscape(string(enrichmentType)))
	req, err := runtime.NewRequest(ctx, http.MethodPost, runtime.JoinPaths(client.internal.Endpoint(), urlPath))
	if err != nil {
		return nil, err
	}
	reqQP := req.Raw().URL.Query()
	reqQP.Set("api-version", "2025-07-01-preview")
	req.Raw().URL.RawQuery = reqQP.Encode()
	req.Raw().Header["Accept"] = []string{"application/json"}
	req.Raw().Header["Content-Type"] = []string{"application/json"}
	if err := runtime.MarshalAsJSON(req, domainBody); err != nil {
		return nil, err
	}
	return req, nil
}

// listWhoisByDomainHandleResponse handles the ListWhoisByDomain response.
func (client *Client) listWhoisByDomainHandleResponse(resp *http.Response) (ClientListWhoisByDomainResponse, error) {
	result := ClientListWhoisByDomainResponse{}
	if err := runtime.UnmarshalAsJSON(resp, &result.EnrichmentDomainWhois); err != nil {
		return ClientListWhoisByDomainResponse{}, err
	}
	return result, nil
}
